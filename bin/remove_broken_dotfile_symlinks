#!/bin/bash

# XXX FIXME
# find: warning: you have specified the -maxdepth option after a non-option argument -type,
# but options are not positional (-maxdepth affects tests specified before it as well as those specified after it).
# Please specify options before other arguments.
#
# rm: missing operand
# Try 'rm --help' for more information.
# ls: cannot access .common-private/sh: No such file or directory
# ln: missing file operand
# Try 'ln --help' for more information.

function find_broken_symlinks {
    DIR=$1
    shift
    find -L $DIR -type l -maxdepth 1 "$@"
}

# not all dotfiles live forever
find_broken_symlinks . -print0 | xargs -0 rm

